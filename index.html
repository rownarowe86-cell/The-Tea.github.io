<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>The Tea ‚òï</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>

<body class="bg-[#Fdfbf7] text-stone-800 min-h-screen">

  <!-- Header -->
  <header class="bg-stone-900 text-white p-4 text-center text-2xl font-bold">
    üçÉ The Tea
  </header>

  <!-- Form -->
  <main class="max-w-2xl mx-auto p-6">
    <div class="bg-white p-6 rounded-xl shadow mb-8">
      <h2 class="text-xl font-bold mb-4">Spill the Tea</h2>

      <form id="teaForm" class="space-y-4">
        <input
          id="author"
          type="text"
          placeholder="Your name (optional)"
          class="w-full border rounded p-2"
        />

        <select id="type" class="w-full border rounded p-2">
          <option value="story">Story / Gossip</option>
          <option value="recipe">Recipe</option>
        </select>

        <textarea
          id="content"
          rows="4"
          placeholder="What's brewing?"
          class="w-full border rounded p-2"
          required
        ></textarea>

        <label class="flex items-center gap-2 text-sm">
          <input type="checkbox" id="terms" />
          I confirm that this content is respectful, safe, and suitable for use by the website owners.
        </label>

        <button
          type="submit"
          class="w-full bg-stone-800 text-white py-2 rounded hover:bg-stone-700"
        >
          Publish
        </button>

        <p id="message" class="text-sm mt-2"></p>
      </form>
    </div>

    <!-- Feed -->
    <div>
      <h3 class="text-lg font-bold mb-4">Recent Pours</h3>
      <div id="feed" class="space-y-4"></div>
    </div>
  </main>

  <!-- Firebase + App Logic -->
  <script>
    /* ---------------- Firebase Config ---------------- */
    const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
};

    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const db = firebase.firestore();

    /* ---------------- Auth ---------------- */
    auth.signInAnonymously().catch(console.error);

    /* ---------------- DOM ---------------- */
    const form = document.getElementById("teaForm");
    const feed = document.getElementById("feed");
    const message = document.getElementById("message");

    /* ---------------- Submit ---------------- */
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const author = document.getElementById("author").value || "Anonymous Tea Lover";
      const content = document.getElementById("content").value.trim();
      const type = document.getElementById("type").value;
      const terms = document.getElementById("terms").checked;

      if (!content || !terms) {
        message.textContent = "Please write something and agree to the terms.";
        message.className = "text-red-600";
        return;
      }

      await db.collection("tea_stories").add({
        author,
        content,
        type,
        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
      });

      form.reset();
      message.textContent = "Tea spilled successfully ‚òï";
      message.className = "text-green-600";
    });

    /* ---------------- Feed ---------------- */
    db.collection("tea_stories")
      .orderBy("timestamp", "desc")
      .onSnapshot((snap) => {
        feed.innerHTML = "";
        snap.forEach((doc) => {
          const d = doc.data();
          const div = document.createElement("div");
          div.className = "bg-white p-4 rounded shadow";
          div.innerHTML = `
            <strong>${d.author}</strong>
            <p class="mt-2">${d.content}</p>
          `;
          feed.appendChild(div);
        });
      });
  </script>
</body>
</html>
